<html>
<META HTTP-EQUIV="EXPIRES" CONTENT="0">
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-162432647-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-162432647-1');
  </script>

  <meta charset="UTF-8">
  <meta property="og:type" content="website" />
  <meta property="og:image" content="http://chrisbillington.net/COVID_NSW.png">
  <meta property="og:title" content="Progression of the COVID outbreak in New South Wales"/>
  <meta property="og:description" content="Plot of cases and estimated R_eff for the COVID outbreak in New South Wales"/>
  <meta property="og:url" content="http://chrisbillington.net/COVID_NSW.html">


  <style type="text/css">
  html * {
    font-family: verdana, arial, sans-serif;
    line-height: 150%;
  }
  div.content { width: 960px; margin:0 auto; }

  #toc_container {
    background: #f9f9f9 none repeat scroll 0 0;
    border: 1px solid #aaa;
    display: table;
    font-size: 14px;
    margin-bottom: 1em;
    padding: 15px;
    width: auto;
  }

  .toc_title {
    font-weight: 700;
  }

  #toc_container li, #toc_container ul, #toc_container ul li{
    list-style: outside none none !important;
  }

</style>

</head>
<body>
  <div class="content">
    Last updated: 2021-12-19 09:25 Melbourne time
    <br>
    <small>
      Updates daily around 9:20AM Sydney time
    </small>
    <h1>
      Progression of the COVID outbreak in New South Wales
    </h1>
    <p>
      <mark><b><a href="COVID.html">←Back to per-country plots</a></b></mark>
    </p>
    <p>
      <span style="background-color: #FF0000" ><b><a href="COVID_NZ.html">Progression of the COVID outbreak in New Zealand</a></b></span>
    </p>
    <p>
      <span style="background-color: #FFA000"><b><a href="COVID_VIC_2021.html">Progression of the COVID outbreak in Victoria</a></b></span>
    </p>
    <p>
      <span style="background-color: #A386D9"><b><a href="COVID_ACT.html">Progression of the COVID outbreak in the Australian Capital Territory</a></b></span>
    </p>
<!--     <p>
      <span style="background-color: #00FF00"><b><a href="COVID_NSW.html">Progression of the COVID outbreak in New South Wales</a></b></span>
    </p> -->
    <p>
      <span style="background-color: #00FFFF"><b><a href="aus_vaccinations.html">Australian vaccination rollout</a></b></span>
    </p>
    <p>
      <span style="background-color: #FF00FF"><b><a href="COVID_VIC.html">The road to a COVID-free Victoria (old 2020 second wave plots)</a></b></span>
    </p>

    <div id="toc_container">
      <p class="toc_title">Contents</p>
      <li><a href="#all"><i>R</i><sub>eff</sub> estimate from all cases</a></li>
      <!-- <li><a href="#noniso"><i>R</i><sub>eff</sub> estimate from non-isolating cases only</a></li> -->
      <li><a href="#sir">SIR model projection</a></li>
      <li><a href="#animated">Animated projections over time</a></li>
      <li><a href="#sydney-vs-others"><i>R</i><sub>eff</sub> in Greater Sydney vs rest of NSW</a></li>
      <li><a href="#regions"><i>R</i><sub>eff</sub> in the Hunter, Illawarra, and Western NSW regions</a></li>
      <li><a href="#concern-vs-others"><i>R</i><sub>eff</sub> in LGAs of concern vs rest of NSW</a></li>
      <!-- <li><a href="#bipartite">Projected effect of vaccines with LGAs of concern treated separately</a></li> -->
      <li><a href="#lga"><i>R</i><sub>eff</sub> in individual LGAs of concern</a></li>
      <li><a href="#disclaimer">Disclaimer on trends</a></li>
      <li><a href="#methodology">Methodology</a></li>
      <li><a href="#details">Data sources and contact</a></li>
    </div>

    <h3 id="all"><i>R</i><sub>eff</sub> estimate from all cases</h3>

    <p>
      New South Wales is currently experiencing an outbreak of COVID, due to the omicron
      variant. This comes after a wave due to the delta variant in mid-2021, during
      which New South Wales was under lockdown restrictions until vaccination levels
      were sufficient to slow the spread of the virus. With the omicron variant having
      significant immune escape, cases are now rising once again.
    </p>
    <p>
      How have New South Wales' restrictions affected the spread of the virus? The below
      plot shows how the effective reproduction number of the virus,
      <i>R</i><sub>eff</sub> has changed over time in New South Wales, as well as how
      the daily cases have changed over time. A trendline shows the approximate
      trajectory daily case numbers would follow, were the reproduction number of the
      virus to remain at its current level.
    </p>
    <p>
      The same plot is shown twice, the first with cases on a linear scale, and the
      second on a log scale—the latter showing how consistently the caseload has
      followed exponential growth (which forms a straight line on a log scale).
    </p>
    <img src="COVID_NSW_linear.svg">
    <img src="COVID_NSW.svg">

<!--     <h3 id="noniso"><i>R</i><sub>eff</sub> estimate from non-isolating cases only</h3>
    <p>
      Cases isolating during their infectious period represent a much lower risk of spread.
      The growth rate of non-isolating cases represents a more leading indicator of whether
      NSW is successfully suppressing the outbreak. The below plot is identical to the above
      one, except it excludes cases that were known to be isolating for their full infectious
      period.
    </p>
    <img src="COVID_NSW_noniso.svg"> -->

    <h3 id="sir">SIR model projection</h3>
    <p>
      The trendline in the above plot simply projects forward case numbers assuming that
      <i>R</i><sub>eff</sub> remains at its current estimated value. What about the
      effect of built-up immunity? Below is a plot with the projected trend taking into
      account an estimated reduction of spread due to increasing immunity from
      infections, which slows transmission once a non-negligible fraction of the
      population has been infected. The projection assumes that only 20% of infections
      are captured by testing, as such, for every projected case there are an additional
      four infections implied that are not detected through testing.
    </p>
    <p>
      This projection shows what might be possible if all other factors affecting
      <i>R</i><sub>eff</sub>—such as restrictions—are held constant. If New South Wales
      introduces restrictions, then <i>R</i><sub>eff</sub> will likely decrease and
      growth will slow, resulting in a later and lower peak in cases than the current
      projection.
    </p>
    <p>
      Even if no restrictions are introduced, people may modify their behaviour once
      caseloads become higher, which also may reduce <i>R</i><sub>eff</sub>.    
    </p>
    <p>
      This type of model is very simplistic, and should be taken with a grain of salt.
      The number of actual cases detected will depend strongly on what fraction of
      infections come forward for testing, which may change over time. Furthermore, this
      model treats the entire state as homogenous, whereas in reality some geographic
      areas or social networks will develop high immunity and thus slower growth before
      others. This can significantly affect the overall rate of spread, but is not
      captured in a simple model such as this.
    </p>
    <p>
      The various effects not included in the model are also not included in the
      projection's uncertainty range, which is solely due uncertainty in the current
      <i>R</i><sub>eff</sub> estimate and average caseload.
    </p>

    <p>
      The same plot is shown twice, the first with cases on a linear scale, and the
      second on a log scale.
    </p>
    <img src="COVID_NSW_vax_linear.svg">
    <img src="COVID_NSW_vax.svg">
    <!-- <p>
      Below are plots of the vaccination rollout in New South Wales to date, in terms of
      daily and cumulative doses per 100 population, with the assumed future rate used
      for the above projections also shown.
    </p>
    <img src="COVID_NSW_projected_doses.svg"> -->

    <h3 id="animated">Animated projections over time</h3>

    <p>
    How have the above projections changed over time? Below are animated versions of
    previous projections, one with cases on a linear scale, and one with cases on a log
    scale, run on old data to show how the projections have changed over time. Note that
    these are not 100% identical to the projections actually made on previous days, as
    there have been some slight methodology changes - but they should be very close.
    </p>
    <p>
    Note that previously, projections were based on an estimated reduction in the rate
    of spread due to vaccines. The model is still the same, but there is no longer any
    expected future effect from increasing vaccines, as the 1st and 2nd dose rollout is
    mostly complete. 3rd doses are being rolled out, and this would affect spread, but
    is not taken into account in the model. At the current rate of spread, the increase
    in 3rd doses is likely to be too insignificant to make much of a difference to the
    omicron wave before it peaks in any case. If the wave is prolonged, I'll look into
    introducing 3rd doses to the model.
    </p>

    <video width=900 controls loop><source src="nsw_animated_linear.webm" type="video/webm"></video>
    <video width=900 controls loop><source src="nsw_animated.webm" type="video/webm"></video>

    <h3 id="sydney-vs-others"><i>R</i><sub>eff</sub> in Greater Sydney vs rest of NSW</h3>
    <p>
      Below are two plots showing case numbers and an estimated <i>R</i><sub>eff</sub>
      value in Greater Sydney (including Central Coast, Shellharbour and Wollongong), and the rest of
      New South Wales <i>excluding</i> Greater Sydney.
    </p>
    <p>
      The data in this plot may be several days out of date due to the delay in New
      South Wales Health releasing data.
    </p>
    <p>
      Note: case numbers on these plots are shown on a log scale.
    </p>
    <img src="COVID_NSW_sydney.svg">
    <img src="COVID_NSW_not_sydney.svg">

    <h3 id="regions"><i>R</i><sub>eff</sub> in the Hunter, Illawarra, and Western NSW regions</h3>

    <p>

      Below are plots showing an estimate of <i>R</i><sub>eff</sub> in
      the Hunter region, Illawarra region, and Western New South
      Wales, as well as case numbers and a trendine on a log scale.

    </p>

    <img src="COVID_NSW_hunter.svg">

    <img src="COVID_NSW_illawarra.svg">

    <img src="COVID_NSW_wnsw.svg">

    <h3 id="concern-vs-others"><i>R</i><sub>eff</sub> in LGAs of concern vs rest of NSW</h3>
    <p>
      Below are two plots showing case numbers and an estimated <i>R</i><sub>eff</sub>
      value in the eleven (former) local government areas designated "of concern", and the rest of
      New South Wales <i>excluding</i> these eleven LGAs. Penrith as a whole is included
      as an LGA of concern, even though only some suburbs of Penrith are designated as
      such.
    </p>
    <p>
      The data in this plot may be several days out of date due to the delay in New
      South Wales Health releasing data.
    </p>
    <p>
      Note: case numbers on these plots are shown on a log scale.
    </p>
    <img src="COVID_NSW_LGA_concern.svg">
    <img src="COVID_NSW_LGA_others.svg">

<!--     <h3 id="bipartite">Projected effect of vaccines with LGAs of concern treated separately</h3>

    <p>
    The above projection of the effect of the vaccine rollout in New South Wales is very
    simplistic. Because it treats the entire state as a single outbreak with a single
    <i>R</i><sub>eff</sub>, it can't accurately describe the substantially different
    rate of spread within the LGAs of concern, compared to the rest of New South Wales.
    In reality, the outbreaks in these two different settings have different
    <i>R</i><sub>eff</sub> values and may peak at different times. Below is a projection
    that treats the two outbreaks separately, projecting each forward based in its
    current <i>R</i><sub>eff</sub> and the same vaccination model, and then adds the
    results together to show a projection of statewide case numbers. The result should
    be more realistic than treating the entire state as a single outbreak. This
    projection does, however, still use statewide vaccination numbers, and would be
    improved if that were further broken down by LGA (It's on my todo list!).
    </p>
    <p>
      Note that the data used for this projection lags the statewide numbers by up to
      several days due to the delay in New South Wales Health publishing LGA breakdowns.
    </p>
    <p>
      The same plot is shown twice, first with cases on a linear scale, then with cases
      on a log scale. Below that, the two individual projections for the outbreak within
      the LGAs of concern, and in the rest of NSW are shown, also on a linear and log
      scale each.
    </p>

    <img src="COVID_NSW_bipartite_linear.svg">
    <img src="COVID_NSW_bipartite.svg">
    <img src="COVID_NSW_concern_vax_linear.svg">
    <img src="COVID_NSW_concern_vax.svg">
    <img src="COVID_NSW_others_vax_linear.svg">
    <img src="COVID_NSW_others_vax.svg"> -->

    <h3 id="lga"><i>R</i><sub>eff</sub> in individual LGAs of concern</h3>
    <p>
      Below are plots of daily case numbers and estimated <i>R</i><sub>eff</sub> values
      in the eleven New South Wales local government areas that have been designated
      "LGAs of concern" by the New South Wales government, and are subject to additional
      restrictions. They are sorted by number of cases in the last fourteen days.
      Penrith as a whole is included, even though only some suburbs of Penrith are
      designated "of concern".
    </p>
    <p>
      The data in these plots may be several days out of date due to the delay in New
      South Wales Health releasing data.
    </p>
    <p>
      Note: case numbers on these plots are shown on a log scale.
    </p>
    <img src="COVID_NSW_LGA_0.svg">
    <img src="COVID_NSW_LGA_1.svg">
    <img src="COVID_NSW_LGA_2.svg">
    <img src="COVID_NSW_LGA_3.svg">
    <img src="COVID_NSW_LGA_4.svg">
    <img src="COVID_NSW_LGA_5.svg">
    <img src="COVID_NSW_LGA_6.svg">
    <img src="COVID_NSW_LGA_7.svg">
    <img src="COVID_NSW_LGA_8.svg">
    <img src="COVID_NSW_LGA_9.svg">
    <img src="COVID_NSW_LGA_10.svg">
    <img src="COVID_NSW_LGA_11.svg">

    <h3 id="disclaimer">Disclaimer on trends</h3>
    <p>
      The plotted trendlines are simple extrapolations of what will happen if
      <i>R</i><sub>eff</sub> remains at its current value. This does not take into account
      that things are in a state of flux. As restrictions take effect, the virus should
      have fewer opportunities for spread, and <i>R</i><sub>eff</sub> will decrease. If
      restrictions are eased, it may increase. Contact tracing may suppress spread to a
      greater or lesser degree over time. The above plots specifically showing the effect
      of vaccines do take into account a reduction in <i>R</i><sub>eff</sub> as
      vaccination coverage increases, but ignore any other possible future changes in
      <i>R</i><sub>eff</sub>.
    </p>
    <p>
      Furthermore, when case numbers are small, the random chance of how many people each
      infected person subsequently infects can cause estimates of <i>R</i><sub>eff</sub>
      to vary randomly in time. As such the projection should be taken with a grain of
      salt—it is merely an indication of the trend as it is right now.
    </p> 

  <h3 id="methodology">Methodology</h3>

  <h4>Padding, smoothing, and calculating <i>R</i><sub>eff</sub></h4>

  <p>
    Before calculating <i>R</i><sub>eff</sub>, the daily case numbers are padded on the
    right and smoothed. A symmetric smoothing method is used, which is why padding on the
    right is necessary before smoothing.
  </p>
  <p>
    The padding is an extrapolation based on a fit to the most recent 14 days of daily case numbers <i>n</i>(<i>t</i>), with the following
    fit function:
  </p>
  <p>

    <i>n</i>(<i>t</i>) = <i>A</i> exp[
    <i>k</i>(
    <i>t</i>-<i>t</i><sub>today</sub>)
    + 1/2 <i>k̇</i> (<i>t</i>-<i>t</i><sub>today</sub>
    )<sup>2</sup>
    ]

  </p>
  <p>
    where <i>A</i> and <i>k</i> are the fit parameters for the current daily caseload and
    exponential growth rate, and <i>k̇</i> is the current expected rate of change of the
    exponential growth rate due to vaccines:
  </p>
  <p>
    <i>k̇</i> = 1 / 𝜏 (<i>s</i><sub>vax</sub>(<i>t</i><sub>today</sub>) /
    <i>s</i><sub>vax</sub>(<i>t</i><sub>yesterday</sub>) - 1)
  </p>
  <p>
    where 𝜏 = 5 days is the approximate mean generation time of the virus, and
    <i>s</i><sub>vax</sub>(<i>t</i><sub>today</sub>) and
    <i>s</i><sub>vax</sub>(<i>t</i><sub>yesterday</sub>) are the fraction of the
    population not protected by vaccination from infection today and yesterday. See <a
    href="#vax-assumptions">vaccination assumptions</a> below for how
    <i>s</i><sub>vax</sub>(<i>t</i>) is calculated from vaccination numbers.
  </p>
  <p>
    After padding, the log of daily case numbers is smoothed with 4-day Gaussian
    smoothing, then the result exponentiated to obtain smoothed daily case numbers:
  </p>
  <p>
    log(<i>n</i><sub>smoothed</sub>(<i>t</i>)) = log(<i>n</i>(<i>t</i>)) ∗
    (2𝜋<i>T</i><sub>s</sub><sup>2</sup>)<sup>-1/2</sup> exp(-<i>t</i><sup>2</sup> /
    2<i>T</i><sub>s</sub><sup>2</sup>)
  </p>
  <p>
    where <i>T</i><sub>s</sub> = 4 days and ∗ is the convolution operation.
  </p>
  </p>
  <p>
    <i>R</i><sub>eff</sub> is then calculated for each day as:
  </p>
  <p>
    <i>R</i><sub>eff</sub>(<i>t<sub>i</sub></i>) =
    (<i>n</i><sub>smoothed</sub>(<i>t<sub>i</sub></i>) /
    <i>n</i><sub>smoothed</sub>(<i>t</i><sub><i>i</i>-1</sub>))<sup>𝜏</sup>.
  </p>
  <p>
    The uncertainty in <i>R</i><sub>eff</sub> has contributions from the uncertainty in
    the above-mentioned fit, as well as uncertainty in daily case numbers. The latter is
    considered to be Poisson noise scaled by a constant, chosen so as to make the reduced
    chi squared between raw and smoothed daily case numbers equal to 1.0.
  </p>

  <h4>Trend based on <i>R</i><sub>eff</sub> only</h4>

  <p>
    The plot(s) with a simple extrapolation of daily case numbers, without taking into
    account the expected effects of vaccines, is exponential growth/decay using the most
    recent value of <i>R</i><sub>eff</sub> and its uncertainty range:
  </p>
  <p>
    <i>n</i><sub>extrap</sub> (<i>t<sub>i</sub></i>) =
    <i>n</i><sub>smoothed</sub>(<i>t</i><sub>today</sub>)
    <i>R</i><sub>eff</sub>(<i>t</i><sub>today</sub>)
    <sup>(<i>t<sub>i</sub></i> - <i>t</i><sub>today</sub>) / 𝜏</sup>
  </p>

  <h4>SIR model with projected effect of vaccines</h4>
  <p>
    To project the effect of vaccines and community immunity on the progression of daily
    cases in the future, I use a stochastic SIR model. The model is run 1000 times to
    project daily case numbers, and the median result and 68% range of outcomes shown in
    the projection.
  </p>
  <p>
    In each run of the model, a random value for each of
    <i>R</i><sub>eff</sub>(<i>t</i><sub>today</sub>) and
    <i>n</i><sub>smoothed</sub>(<i>t</i><sub>today</sub>) is drawn from a multivariate
    normal distribution, using the mean values and covariance of the estimates of the two
    parameters.
  </p>
  <p>
    The initial infectious population is taken to be:
  </p>
  <p>
    <i>i</i>(<i>t</i><sub>today</sub>) =
    𝜏 <i>n</i><sub>smoothed</sub>(<i>t</i><sub>today</sub>)
  </p>
  <p>
    The initial recovered population <i>r</i>(<i>t</i><sub>today</sub>) is taken to be the
    cumulative number of cases so far in the outbreak, minus the currently infectious
    population.
  </p>
  <p>
    Each day, the fraction of the population susceptible to infection <i>s</i>(<i>t</i>) is
    taken to be
  </p>
  <p>
    <i>s</i>(<i>t</i>) = <i>s</i><sub>vax</sub>(<i>t</i>) [1 - (<i>r</i>(<i>t</i>) +
    <i>i</i>(<i>t</i>)) / <i>N</i>]
  </p>
  <p>

    where <i>s</i><sub>vax</sub>(<i>t</i>) is the fraction of the population not
    protected from infection by vaccines (see See <a href="#vax-assumptions">below</a>
    for how this is calculated), and <i>N</i> is the total population multiplied by the
    fraction of infections assumed to come forward for testing (20%).
  </p>
  <p>
    Assuming that <i>R</i><sub>eff</sub> is proportional to the susceptible fraction of
    the population, we can estimate what the reproduction number of the virus would be in
    the absence of any vaccines or immunity from infection:
  </p>
  <p>
    <i>R</i><sub>naive</sub> = <i>R</i><sub>eff</sub>(<i>t</i><sub>today</sub>) /
    <i>s</i>(<i>t</i><sub>today</sub>)
  </p>
  <p>
    And compute an <i>R</i><sub>eff</sub> for each future day based on the susceptible
    fraction of the population that day:
  </p>
  <p>
    <i>R</i><sub>eff</sub>(<i>t</i>) = <i>s</i>(<i>t</i>) <i>R</i><sub>naive</sub>
  </p>
  <p>
    Each day of the model, the infectious population is increased by the number of new
    infections, and decreased by the number of new recoveries. The recovered population is
    increased by the number of new recoveries.
  </p>
  <p>
    The number of new infections each day is drawn from a Poission distribution with mean
    equal to <i>i</i>(<i>t</i>) <i>R</i><sub>eff</sub>(<i>t</i>) / 𝜏.
  </p>
  <p>
    The number of new recoveries each days is drawn from a binomial distribution with
    number of trials equal to the infectious population <i>i</i>(<i>t</i>), and with
    probability 1 / 𝜏.
  </p>
  <h4 id="vax-assumptions">Vaccination assumptions</h4>
  <p>
    To model vaccines taking effect after a delay, daily vaccine dose numbers
    <i>v</i>(<i>t</i>) are convolved with a Gaussian function offset 1.5 weeks in the
    future, with standard deviation 0.5 weeks:
  </p>
  <p>
    <i>v</i><sub>effective</sub>(<i>t</i>) = <i>v</i>(<i>t</i>) ∗
    (2𝜋<i>σ</i><sup>2</sup>)<sup>-1/2</sup> exp(-(<i>t</i> - <i>μ</i>)<sup>2</sup> /
    2<i>σ</i><sup>2</sup>)
  </p>
  <p>
    where <i>μ</i> = 10.5 days, <i>σ</i> = 3.5 days, and ∗ is the convolution
    operation. This causes the effect of a vaccine dose to over the course of the
    second week after it is adminsitered, reaching nearly full effectiveness
    approximately two weeks after administration.
  </p>
  <p>
    I assume that one dose of any vaccine reduces spread by 40%, and two doses reduce
    spread by 80%. The proportion of the population not protected by the vaccine against
    infection is then:
  </p>
  <p>
    <i>s</i><sub>vax</sub>(<i>t<sub>i</sub></i>) = 1 - 0.4 × <i>d</i>(<i>t</i><sub><i>i</i></sub>)
  </p>
  <p>
    where <i>d</i>(<i>t</i><sub><i>i</i></sub>) is the cumulative number of doses per
    capita on each day.
  </p>




    <h3 id="details">Data sources and contact</h3>

    <p>
      Source for case numbers:
      <a href="https://covidlive.com.au/report/daily-source-overseas/nsw">covidlive.com.au</a> and <a href="https://data.nsw.gov.au/data/dataset/covid-19-cases-by-location/resource/21304414-1ff1-4243-a5d2-f52778048b29">NSW Health</a>
    </p>
    <p>
      Plots/analysis by Chris Billington. Contact: chrisjbillington [at] gmail [dot] com
    </p>
    <p>
      Python script for producing the plots can be found at <a href="https://github.com/chrisjbillington/chrisjbillington.github.io/blob/master/nsw.py">GitHub</a>.
    </p>
  </div>
</body>
</html>
